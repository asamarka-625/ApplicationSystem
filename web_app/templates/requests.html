{% extends "base.html" %}

{% block content %}
<section id="requests" class="content-section">
    <div class="section-header">
        <h1>Заявки</h1>
        <div class="filters">
            <select id="statusFilter">
                <option value="">Все статусы</option>
            </select>
            <select id="typeFilter">
                <option value="">Все типы</option>
            </select>
            <button class="btn btn-secondary" onclick="exportToExcel()">
                <i class="fas fa-file-excel"></i> Экспорт в Excel
            </button>
        </div>
    </div>

    <div class="requests-table-container">
        <table class="requests-table">
            <thead>
                <tr>
                    <th>№ заявки</th>
                    <th>Тип</th>
                    <th>Статус</th>
                    <th>Срочность</th>
                    <th>Дата создания</th>
                    <th>Срок выполнения</th>
                    <th>Действия</th>
                </tr>
            </thead>
            <tbody id="requestsTableBody">
                <!-- Данные будут загружены через JavaScript -->
            </tbody>
        </table>
    </div>
</section>
<!-- Модальное окно для отклонения заявки -->
<div id="rejectModal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h2>Отклонение заявки</h2>
        <form id="rejectForm">
            <div class="form-group">
                <label for="rejectReason">Причина отклонения:</label>
                <textarea
                    id="rejectReason"
                    name="reason"
                    rows="4"
                    placeholder="Укажите причину отклонения заявки..."
                    required
                ></textarea>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn btn-secondary" id="cancelReject">Отмена</button>
                <button type="submit" class="btn btn-danger" id="confirmReject">Отклонить заявку</button>
            </div>
        </form>
    </div>
</div>
<input type="hidden" id="selectedDate" name="selected_date">
<input type="hidden" id="selectedTime" name="selected_time">
<!-- Модальное окно для выбора даты и времени -->
<div id="dateTimeModal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h2>Выберите дату и время</h2>

        <div class="datetime-picker">
            <div class="date-section">
                <h3>Дата:</h3>
                <input type="date" id="dateInput" class="date-input" min="">
            </div>

            <div class="time-section">
                <h3>Время:</h3>
                <select id="timeSelect" class="time-select">
                    <option value="">Выберите время</option>
                    <!-- Опции будут заполнены JavaScript -->
                </select>
            </div>

            <div class="selected-info">
                <p>Выбрано: <span id="selectedDisplay">—</span></p>
            </div>

            <div class="modal-actions">
                <button type="button" class="btn btn-secondary" id="cancelDateTime">Отмена</button>
                <button type="button" class="btn btn-primary" id="confirmDateTime" disabled>Подтвердить</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}