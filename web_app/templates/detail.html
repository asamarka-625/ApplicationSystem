{% extends "base.html" %}

{% block content %}
<div id="actionPanel" class="action-panel" style="display: none;">
    <div class="action-buttons-top"></div>
</div>
<div id="requestDetails" style="display: none;">
    <h2>Детали заявки <span id="registrationNumber"></span></h2>

    <table class="details-table">
        <tr>
            <th>ID заявки</th>
            <td id="regNumber"></td>
        </tr>
        <tr>
            <th>Регистрационный номер</th>
            <td id="humanRegistrationNumber"></td>
        </tr>
         <tr>
            <th>Документ</th>
             <td><a class="btn btn-primary" id="pdf_request" style="width: 14rem;">Документ</a></td>
        </tr>
        <tr>
            <th>Тип заявки</th>
            <td id="requestType"></td>
        </tr>
        <tr>
            <th>Статус</th>
            <td><span id="statusBadge" class="status-badge"></span></td>
        </tr>
        <tr>
            <th>Предметы</th>
            <td id="items"></td>
        </tr>
        <tr>
            <th>Описание</th>
            <td id="description"></td>
        </tr>
        <tr id="for_description_management" style="display: none;">
            <th>Комментарий для сотрудника управления отдела</th>
            <td id="description_management_department"></td>
        </tr>
        <tr>
            <th>Срочность</th>
            <td id="emergency"></td>
        </tr>
        <tr>
            <th>Судебный участок</th>
            <td id="department"></td>
        </tr>
        <tr>
            <th>Секретарь</th>
            <td>
                <button id="secretary_name"></button>
            </td>
        </tr>
        <tr>
            <th>Мировой судья</th>
            <td>
                <button id="judge_name"></button>
            </td>
        </tr>
        <tr>
            <th>Сотрудник управления</th>
            <td>
                <button id="management_name"></button>
            </td>
        </tr>
        <tr>
            <th>Сотрудник управления отдела</th>
            <td>
                <button id="management_department_name"></button>
            </td>
        </tr>
        <tr>
            <th>Дата создания</th>
            <td id="createdAt"></td>
        </tr>
        <tr>
            <th>Дата выполнения</th>
            <td id="completedAt"></td>
        </tr>
        <tr>
            <th>Дата обновления</th>
            <td id="updatedAt"></td>
        </tr>
        <tr>
            <th>Прикрепленные файлы</th>
            <td id="attachments"></td>
        </tr>
    </table>

    <div class="history-section">
        <h3>История изменений</h3>
        <table class="history-table" id="historyTable">
            <thead>
                <tr>
                    <th>Дата</th>
                    <th>Действие</th>
                    <th>Описание</th>
                    <th>Пользователь</th>
                </tr>
            </thead>
            <tbody id="historyBody">
            </tbody>
        </table>
    </div>
</div>
<div id="userModal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h2>Информация о пользователе</h2>
        <div id="userInfo" class="user-info"></div>
        <div class="modal-actions">
            <button type="button" class="btn btn-secondary" id="closeModal">Закрыть</button>
        </div>
    </div>
</div>
<div id="executorModal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h2>Назначить исполнителя для предмета</h2>
        <div class="modal-body">
            <div class="form-group">
                <label>Выберите исполнителя:</label>
                <div class="executor-list-container">
                    <div class="executor-suggestions" id="executorSuggestions" style="display: block; position: static; border: 1px solid #ddd; border-radius: 4px; max-height: 300px; overflow-y: auto;">
                        <!-- Список исполнителей будет здесь -->
                    </div>
                </div>
            </div>
            <div id="selectedExecutor" class="selected-executor" style="display: none;">
                <strong>Выбран:</strong> <span id="selectedExecutorName"></span>
                <input type="hidden" id="selectedExecutorId">
            </div>

            <div class="form-group">
                <label for="executionComment">Комментарий к назначению:</label>
                <textarea
                    id="executionComment"
                    class="form-control"
                    rows="3"
                    placeholder="Введите комментарий для исполнителя..."
                ></textarea>
            </div>

            <div class="form-group">
                <label for="executionDeadline">Срок исполнения:</label>
                <input
                    type="date"
                    id="executionDeadline"
                    class="form-control"
                >
            </div>
        </div>
        <div class="modal-actions">
            <button type="button" class="btn btn-secondary" id="cancelExecutor">Отмена</button>
            <button type="button" class="btn btn-primary" id="assignExecutor">Назначить</button>
        </div>
    </div>
</div>
<div id="rejectModal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h2>Отклонение заявки</h2>
        <form id="rejectForm">
            <div class="form-group">
                <label for="rejectReason">Причина отклонения:</label>
                <textarea
                    id="rejectReason"
                    name="reason"
                    rows="4"
                    placeholder="Укажите причину отклонения заявки..."
                    required
                ></textarea>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn btn-secondary" id="cancelReject">Отмена</button>
                <button type="submit" class="btn btn-danger" id="confirmReject">Отклонить заявку</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}